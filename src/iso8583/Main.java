package iso8583;

import java.io.IOException;

import iso8583.config.IsoConfigConverter;
import iso8583.config.MensagemIsoConfig;
import iso8583.config.old.OldConfigReader;
import iso8583.config.old.OldIsoConfig;
import iso8583.config.sizeheader.SizeHeaderConfig;
import iso8583.config.sizeheader.SizeHeaderConfigReader;

public class Main {

	

	public static void main(String[] args) {

		OldIsoConfig old;
		MensagemIsoConfig config;
		
	//	String testeCredibacon = "017849534f3032363030303031333032313042323338383438313245433139303141303030303030303031303030303030383030323030303030303030303638333434323131313431373230313630303039323431343139323231313134313131343032313030313131303030303030303039303337343537363033303030303135383130383d32333132323236313734353439353430303030303130303030303030303932343630353935355031303030444630343420202020202020203031202030313139313837343520203032373031313931383734352020202020202020202030303030303030303137304646464646464646464646464646464630313630303930544553322b30303030303030303139323030315445533230303030303030303030303034382620303030303230303034382120433030303032362020202020202020202020202020202020202020202020202020203131323030303030303030303130313256444232342042323420312003";
		String testeNashville = "3034393901007238478228C08232164122943420956225000000000000000100050509074600000609074605055999005100010052000131274122943420956225D2411221486F3030303030303030303030353031303639383836303030303834303030323130303035048402054F07A00000000310109F120B564953412044454249544F500B564953412044454249544F5F3401019F3403010302950580800080009F2701809F26087317AC6237CE5EC49B0268009F3901515F24032411305F2A02048482021C008407A00000000310109A032105059C01009F02060000000001009F03060000000000009F0607A00000000310109F0802009A9F0902008D9F100706010A03A480009F1A0204849F1E0830333932313635389F3303E0B0C89F3501229F360201459F370471C88B399F4104000000079F5301520931313535302020202045017500483134592020202020202020202020202020202020202020203030303030303030303030303030303030303030303030300060333631000000000000000000003132333435000000000000000000000000000000000000000000000000000000000000000000000000000000000000002336393031310B5643494E440000000000005443523031340028534458433030313254433031353430313131313130303030303030300002564900024556";
		
		
		byte[] dump = Util.asciiToBytes(testeNashville.getBytes());
		//byte[] dump = Util.asciiToBytes(testeCredibacon.getBytes());
		
		try {
			old = OldConfigReader.readIsoConfig("config/iso2.yml");
			config = IsoConfigConverter.convert(old);
			
			SizeHeaderConfig sizeHeader = SizeHeaderConfigReader.readConfig("config/size2.yml");
						
			MensagemIso msg = MensagemIsoParser.parseIso(dump, config, sizeHeader);
			
			System.out.println("\n\n\n");
			System.out.println(msg.prettyPrint());
			System.out.println("\n\n\n");
			
			System.out.println(new String(msg.toByteArray()));
			
			
		} catch (IOException e) {
			e.printStackTrace();
		}
		
	}
	
	
}
